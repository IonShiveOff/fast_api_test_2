# üìä Transactions Analytics API

FastAPI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π —Å
–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º:

-   üöÄ FastAPI
-   üêò PostgreSQL
-   üß† SQLAlchemy 2.0
-   üê≥ Docker & Docker Compose
-   üß™ Pytest + Coverage

------------------------------------------------------------------------

## üìå –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

-   –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
-   –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π
-   –ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏
-   –ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º (CSV)
-   –ü–æ–∫—Ä—ã—Ç–∏–µ —Ç–µ—Å—Ç–∞–º–∏

------------------------------------------------------------------------

# üöÄ –ó–∞–ø—É—Å–∫ —á–µ—Ä–µ–∑ Docker (–ª–æ–∫–∞–ª—å–Ω–æ)

## 1Ô∏è‚É£ –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

–£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ:

-   Docker
-   Docker Compose v2+

–ü—Ä–æ–≤–µ—Ä–∫–∞:

``` bash
docker --version
docker compose version
```

------------------------------------------------------------------------

## 2Ô∏è‚É£ –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

``` bash
git clone <your-repository-url>
cd <project-folder>
```

------------------------------------------------------------------------

## 3Ô∏è‚É£ –°–æ–∑–¥–∞—Ç—å —Ñ–∞–π–ª `.env`

–í –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞:

``` env
POSTGRES_DB=testdb
POSTGRES_USER=postgres
POSTGRES_PASSWORD=postgres
POSTGRES_HOST=db
POSTGRES_PORT=5432
```

‚ö†Ô∏è `POSTGRES_HOST=db` --- —ç—Ç–æ –∏–º—è —Å–µ—Ä–≤–∏—Å–∞ –∏–∑ docker-compose.yml

------------------------------------------------------------------------

## 4Ô∏è‚É£ –°–±–æ—Ä–∫–∞ –∏ –∑–∞–ø—É—Å–∫

``` bash
docker compose up --build
```

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞:

-   API –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–µ–Ω –Ω–∞: http://localhost:8000
-   Swagger: http://localhost:8000/docs
-   ReDoc: http://localhost:8000/redoc

------------------------------------------------------------------------

# üß™ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

–í–æ–π—Ç–∏ –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä:

``` bash
docker compose exec app bash
```

–ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã:

``` bash
pytest
```

–° –ø–æ–∫—Ä—ã—Ç–∏–µ–º:

``` bash
pytest --cov=main --cov-report=html
```

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ—è–≤–∏—Ç—Å—è –ø–∞–ø–∫–∞:

    htmlcov/

–û—Ç–∫—Ä–æ–π—Ç–µ:

    htmlcov/index.html

------------------------------------------------------------------------

# üì° –û—Å–Ω–æ–≤–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã

### GET `/users`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: - `limit` - `active_only`

------------------------------------------------------------------------

### GET `/transactions`

–ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–π

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: - `limit` - `status` (successful, failed, all) -
`transaction_type` (payment, invoice, all)

------------------------------------------------------------------------

### GET `/report`

–ê–Ω–∞–ª–∏—Ç–∏—á–µ—Å–∫–∏–π –æ—Ç—á—ë—Ç

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: - `start_date` - `end_date` - `status` - `type` -
`include_avg` - `include_min` - `include_max` - `include_daily_shift`

–ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –æ—Ç—á—ë—Ç —Å—Ç—Ä–æ–∏—Ç—Å—è –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–µ—Å—è—Ü.

------------------------------------------------------------------------

### GET `/report/by-country`

–ê–≥—Ä–µ–≥–∞—Ü–∏—è –ø–æ —Å—Ç—Ä–∞–Ω–∞–º

–ü–∞—Ä–∞–º–µ—Ç—Ä—ã: - `sort_by` (count, total, avg) - `top_n` - `status`

‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç—Å—è —Ñ–∞–π–ª:

    user-country (Test task).csv

------------------------------------------------------------------------

# üóÑ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î

PostgreSQL:

-   Host: localhost
-   Port: 5432
-   Database: testdb
-   User: postgres
-   Password: postgres

------------------------------------------------------------------------

# üõë –û—Å—Ç–∞–Ω–æ–≤–∫–∞ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–≤

``` bash
docker compose down
```

–£–¥–∞–ª–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ë–î:

``` bash
docker compose down -v
```

------------------------------------------------------------------------

# üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

    .
    ‚îú‚îÄ‚îÄ __init__.py
    ‚îú‚îÄ‚îÄ main.py
    ‚îú‚îÄ‚îÄ db.py
    ‚îú‚îÄ‚îÄ models.py
    ‚îú‚îÄ‚îÄ generate_seed_script.py
    ‚îú‚îÄ‚îÄ pytest.ini
    ‚îú‚îÄ‚îÄ test_main.py
    ‚îú‚îÄ‚îÄ docker-compose.yml
    ‚îú‚îÄ‚îÄ Dockerfile
    ‚îú‚îÄ‚îÄ requirements.txt
    ‚îú‚îÄ‚îÄ user-country (Test task).csv
    ‚îú‚îÄ‚îÄ .env
    ‚îú‚îÄ‚îÄ .gitignore
    ‚îî‚îÄ‚îÄ README.md

------------------------------------------------------------------------

# üë®‚Äçüíª –ê–≤—Ç–æ—Ä

Makhat Tumenbayev
